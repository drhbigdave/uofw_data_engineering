{"paragraphs":[{"text":"%spark2.pyspark\nfrom pyspark.sql.types import StructType, StringType, StructField\n\ndef parseEmail(email):\n    fields = email.split(\"Subject:\")[0].split('\\n')\n    messageID = fields[0].split(':')[1].strip()\n    date = fields[1].split(':')[1].strip()\n    sender = fields[2].split(':')[1].strip()\n    message = email.replace('\\n','').replace('\\t','').strip()\n\n    receivers = email.split(\"To:\")[1].split('Subject:')[0].split(',')\n    clean_receivers = [i.strip() for i in receivers]\n    to = \",\".join(clean_receivers)\n    return([messageID,date,sender,to,message])\n\nschema = StructType([\n    StructField(\"MessageID\", StringType()),\n    StructField(\"Date\", StringType()),\n    StructField(\"From\", StringType()),\n    StructField(\"To\", StringType()),\n    StructField(\"Message\", StringType())])\n\n\nmydata = sc.wholeTextFiles('file:///data/maildir/*/inbox/*')\nemails = mydata.map(lambda x: x[1]).map(lambda x: parseEmail(x))\nspark.createDataFrame(emails, schema=schema).write.format('csv').options(header='false').save('file:///tmp/enron')\n\n# to view the dataframe to ensure everything is working\n#df = spark.createDataFrame(emails, schema=schema)\n#df.show(200)","user":"anonymous","dateUpdated":"2019-05-01T00:25:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------------------+--------------------+--------------------+--------------------+\n|           MessageID|               Date|                From|                  To|             Message|\n+--------------------+-------------------+--------------------+--------------------+--------------------+\n|<16159836.1075855...| Fri, 7 Dec 2001 10|heather.dunton@en...|  k..allen@enron.com|Message-ID: <1615...|\n|<14955894.1075855...|Sun, 30 Dec 2001 22|anchordesk_daily@...|    pallen@enron.com|Message-ID: <1495...|\n|<7462038.10758553...|Sun, 30 Dec 2001 23|subscriptions@int...|    pallen@enron.com|Message-ID: <7462...|\n|<21572157.1075855...|Mon, 31 Dec 2001 02|prizemachine@feed...|    pallen@enron.com|Message-ID: <2157...|\n|<7618763.10758553...|Mon, 31 Dec 2001 10|louise.kitchen@en...|wes.colwell@enron...|Message-ID: <7618...|\n|<4845954.10758553...|Mon, 31 Dec 2001 17|arsystem@mailman....|  k..allen@enron.com|Message-ID: <4845...|\n|<9354794.10758553...|Mon, 31 Dec 2001 22|anchordesk_daily@...|    pallen@enron.com|Message-ID: <9354...|\n|<23518365.1075855...|Mon, 31 Dec 2001 15|exclusive_offers@...|    pallen@enron.com|Message-ID: <2351...|\n|<1954142.10758553...| Tue, 1 Jan 2002 14|subscriptions@int...|    pallen@enron.com|Message-ID: <1954...|\n|<27039304.1075855...| Tue, 1 Jan 2002 14|subscriptions@int...|    pallen@enron.com|Message-ID: <2703...|\n|<21920205.1075855...| Tue, 1 Jan 2002 17|arsystem@mailman....|  k..allen@enron.com|Message-ID: <2192...|\n|<8802987.10758553...|Mon, 10 Dec 2001 14|brad.jones@enron.com|'daniel.mcdonagh@...|Message-ID: <8802...|\n|<18347911.1075858...|Tue, 11 Sep 2001 10|hunter.williams@g...|   gthorse@keyad.com|Message-ID: <1834...|\n|<8113917.10758586...|Tue, 11 Sep 2001 14|hunter.williams@g...|   gthorse@keyad.com|Message-ID: <8113...|\n|<5393535.10758586...|Wed, 10 Oct 2001 09|richard.morgan@au...|  k..allen@enron.com|Message-ID: <5393...|\n|<18628257.1075858...|Tue, 23 Oct 2001 15| jsmith@austintx.com|  k..allen@enron.com|Message-ID: <1862...|\n|<22278903.1075858...|Thu, 25 Oct 2001 13|wise.counsel@lpl.com|  k..allen@enron.com|Message-ID: <2227...|\n|<7617520.10758586...|Thu, 25 Oct 2001 12|renee.ratcliff@en...|  k..allen@enron.com|Message-ID: <7617...|\n|<17507447.1075858...|Thu, 25 Oct 2001 13|msimpkins@winstea...|pallen@enron.com,...|Message-ID: <1750...|\n|<8855273.10758586...|Thu, 25 Oct 2001 13|msimpkins@winstea...|pallen@enron.com,...|Message-ID: <8855...|\n|<16679015.1075858...|Fri, 26 Oct 2001 07|   gthorse@keyad.com|  k..allen@enron.com|Message-ID: <1667...|\n|<10482145.1075858...|Mon, 29 Oct 2001 08|monica.l.brown@ac...|    pallen@enron.com|Message-ID: <1048...|\n|<10326858.1075855...|Mon, 10 Dec 2001 15|david.port@enron.com|  k..allen@enron.com|Message-ID: <1032...|\n|<12656490.1075858...|Mon, 29 Oct 2001 10|wise.counsel@lpl.com|  k..allen@enron.com|Message-ID: <1265...|\n|<16084919.1075858...|Mon, 29 Oct 2001 09|monica.l.brown@ac...|  k..allen@enron.com|Message-ID: <1608...|\n|<24734819.1075858...|Mon, 29 Oct 2001 14|webmaster@earning...|    pallen@enron.com|Message-ID: <2473...|\n|<12246129.1075858...|Mon, 29 Oct 2001 14|webmaster@earning...|    pallen@enron.com|Message-ID: <1224...|\n|<31359005.1075858...|Mon, 29 Oct 2001 14| delivers@amazon.com|    pallen@enron.com|Message-ID: <3135...|\n|<11341209.1075858...|Mon, 29 Oct 2001 15|james.bruce@enron...|k..allen@enron.co...|Message-ID: <1134...|\n|<22534132.1075858...|Mon, 29 Oct 2001 15|ei_editor@ftenerg...|einsighthtml@list...|Message-ID: <2253...|\n|<2293483.10758586...|Mon, 29 Oct 2001 16|kathryn.sheppard@...|cooper.richey@enr...|Message-ID: <2293...|\n|<26086640.1075858...|Mon, 29 Oct 2001 16|arsystem@mailman....|  k..allen@enron.com|Message-ID: <2608...|\n|<15955949.1075858...|Mon, 29 Oct 2001 16|james.bruce@enron...|k..allen@enron.co...|Message-ID: <1595...|\n|<19990687.1075855...|Tue, 11 Dec 2001 11|c..gossett@enron.com|steven.l.allen@ch...|Message-ID: <1999...|\n|<4623877.10758586...|Mon, 29 Oct 2001 16|  iwon@info.iwon.com|    pallen@enron.com|Message-ID: <4623...|\n|<1449918.10758586...|Mon, 29 Oct 2001 17|arsystem@mailman....|  k..allen@enron.com|Message-ID: <1449...|\n|<8268911.10758586...|Mon, 29 Oct 2001 18|    mondohed@gte.net|pallen@ect.enron.com|Message-ID: <8268...|\n|<26692207.1075858...|Mon, 29 Oct 2001 18|subscriptions@int...|    pallen@enron.com|Message-ID: <2669...|\n|<26738394.1075858...|Mon, 29 Oct 2001 19|no.address@enron.com|All Enron Worldwi...|Message-ID: <2673...|\n|<31239550.1075858...|Mon, 29 Oct 2001 21|enron_update@conc...|    pallen@enron.com|Message-ID: <3123...|\n|<2952100.10758553...|Mon, 17 Dec 2001 08|steven.matthews@u...|  k..allen@enron.com|Message-ID: <2952...|\n|<22507094.1075855...|Thu, 27 Dec 2001 14|louise.kitchen@en...|tim.belden@enron....|Message-ID: <2250...|\n|<19495537.1075862...| Fri, 2 Nov 2001 12|renee.ratcliff@en...|  k..allen@enron.com|Message-ID: <1949...|\n|<2467021.10758621...|Mon, 19 Nov 2001 15|geninfo@state-ban...|undisclosed-recip...|Message-ID: <2467...|\n|<23501072.1075862...|Tue, 20 Nov 2001 10|geninfo@state-ban...|undisclosed-recip...|Message-ID: <2350...|\n|<13304781.1075862...|Fri, 23 Nov 2001 09|kirk.mcdaniel@enr...|  k..allen@enron.com|Message-ID: <1330...|\n|<6722149.10758621...|Tue, 27 Nov 2001 08|kirk.mcdaniel@enr...|michelle.cash@enr...|Message-ID: <6722...|\n|<1389428.10758621...|Tue, 27 Nov 2001 08|kirk.mcdaniel@enr...|michelle.cash@enr...|Message-ID: <1389...|\n|<31788530.1075862...|Tue, 27 Nov 2001 11|mery.l.brown@acce...|    pallen@enron.com|Message-ID: <3178...|\n|<16163432.1075862...|Tue, 27 Nov 2001 11|gthorse@about-cis...|  k..allen@enron.com|Message-ID: <1616...|\n|<17633117.1075855...|Sat, 29 Dec 2001 15|gthorse@about-cis...|pallen70@hotmail.com|Message-ID: <1763...|\n|<2123429.10758621...|Tue, 27 Nov 2001 13|ryan.o'rourke@enr...|k..allen@enron.co...|Message-ID: <2123...|\n|<20123659.1075862...|Tue, 27 Nov 2001 16|leanne@integrityr...|leanne@integrityr...|Message-ID: <2012...|\n|<23221832.1075862...|Tue, 27 Nov 2001 15|melissaspears@ope...|    pallen@enron.com|Message-ID: <2322...|\n|<17733064.1075862...|Tue, 27 Nov 2001 17|  jwills3@swbell.net|  k..allen@enron.com|Message-ID: <1773...|\n|<9144651.10758621...|Tue, 27 Nov 2001 17|michelle.akers@en...|k..allen@enron.co...|Message-ID: <9144...|\n|<14859009.1075862...|Tue, 27 Nov 2001 17|arsystem@mailman....|  k..allen@enron.com|Message-ID: <1485...|\n|<26175277.1075863...|Fri, 16 Nov 2001 10|greg.whalley@enro...|  k..allen@enron.com|Message-ID: <2617...|\n|<29285102.1075863...|Fri, 16 Nov 2001 12|mery.l.brown@acce...|    pallen@enron.com|Message-ID: <2928...|\n|<7059385.10758553...|Sun, 30 Dec 2001 13|software@mail02.u...|    pallen@enron.com|Message-ID: <7059...|\n|<33335249.1075863...|Sun, 25 Nov 2001 19|pallen70@hotmail.com|    pallen@enron.com|Message-ID: <3333...|\n|<7182251.10758631...|Mon, 26 Nov 2001 08|david.oxley@enron...|  k..allen@enron.com|Message-ID: <7182...|\n|<16804123.1075863...|Mon, 26 Nov 2001 15|mery.l.brown@acce...|    pallen@enron.com|Message-ID: <1680...|\n|<32797781.1075863...|Mon, 26 Nov 2001 15|     gift@amazon.com|    pallen@enron.com|Message-ID: <3279...|\n|<102930.107586314...|Mon, 26 Nov 2001 16|geninfo@state-ban...|undisclosed-recip...|Message-ID: <1029...|\n|<32169781.1075855...|Sun, 30 Dec 2001 18|unsubscribe-i@net...|    pallen@enron.com|Message-ID: <3216...|\n|<893627.107585272...|Wed, 16 May 2001 10|dudley.poston@wil...|   jarnold@enron.com|Message-ID: <8936...|\n|<23905606.1075852...|Thu, 13 Sep 2001 07|john.lavorato@enr...|john.arnold@enron...|Message-ID: <2390...|\n|<29857442.1075855...| Tue, 1 Jan 2002 11|     msagel@home.com|   jarnold@enron.com|Message-ID: <2985...|\n|<766167.107585272...|Thu, 20 Sep 2001 13|adrianne.engler@e...|k..allen@enron.co...|Message-ID: <7661...|\n|<25624995.1075852...|Thu, 20 Sep 2001 13|john.cummings@enr...|l..nowlan@enron.c...|Message-ID: <2562...|\n|<8165111.10758527...|Mon, 24 Sep 2001 07|danaggie@hotmail.com|john.arnold@enron...|Message-ID: <8165...|\n|<17099310.1075861...|Tue, 30 Oct 2001 08|steve.c.lengkeekj...|john.arnold@enron...|Message-ID: <1709...|\n|<27954483.1075861...|Tue, 30 Oct 2001 09|steve.lafontaine@...|   jarnold@enron.com|Message-ID: <2795...|\n|<1850165.10758616...|Wed, 31 Oct 2001 05|john.griffith@enr...|john.arnold@enron...|Message-ID: <1850...|\n|<26959222.1075852...|Tue, 25 Sep 2001 09|frank.hayden@enro...|jim.schwieger@enr...|Message-ID: <2695...|\n|<24325440.1075861...|Wed, 31 Oct 2001 07|john.cummings@enr...|john.arnold@enron...|Message-ID: <2432...|\n|<10472358.1075861...|Wed, 31 Oct 2001 09|r..harrington@enr...|dana.davis@enron....|Message-ID: <1047...|\n|<15925673.1075861...| Fri, 2 Nov 2001 11|  bcollins@nymex.com|john.arnold@enron...|Message-ID: <1592...|\n|<32639492.1075861...|Thu, 15 Nov 2001 05|frank.hayden@enro...|john.arnold@enron...|Message-ID: <3263...|\n|<24093478.1075861...|Thu, 15 Nov 2001 11|frank.hayden@enro...|john.arnold@enron...|Message-ID: <2409...|\n|<4203497.10758616...|Thu, 15 Nov 2001 14|dutch.quigley@enr...|     djones@aigi.com|Message-ID: <4203...|\n|<16106569.1075861...|Fri, 16 Nov 2001 08|r..shepperd@enron...|steve.woods@enron...|Message-ID: <1610...|\n|<19507617.1075861...|Fri, 16 Nov 2001 12|dutch.quigley@enr...|john.arnold@enron...|Message-ID: <1950...|\n|<4167938.10758616...|Sun, 18 Nov 2001 08|john.lavorato@enr...|john.arnold@enron...|Message-ID: <4167...|\n|<22448070.1075861...|Tue, 20 Nov 2001 06|tanya.rohauer@enr...|john.arnold@enron...|Message-ID: <2244...|\n|<18157209.1075852...|Thu, 27 Sep 2001 06|louise.kitchen@en...|  c..bland@enron.com|Message-ID: <1815...|\n|<32238679.1075861...|Wed, 21 Nov 2001 07|kristin.gandy@enr...|john.arnold@enron...|Message-ID: <3223...|\n|<32068903.1075861...|Thu, 22 Nov 2001 06|john.lavorato@enr...|john.arnold@enron...|Message-ID: <3206...|\n|<30766975.1075861...|Sun, 25 Nov 2001 21|enron_update@conc...|   jarnold@enron.com|Message-ID: <3076...|\n|<26765338.1075861...|Mon, 26 Nov 2001 05|lara.leibman@enro...|richard.shapiro@e...|Message-ID: <2676...|\n|<14335026.1075861...|Mon, 26 Nov 2001 06|caroline.abramo@e...|john.arnold@enron...|Message-ID: <1433...|\n|<7976878.10758616...|Mon, 26 Nov 2001 06|dutch.quigley@enr...|john.arnold@enron...|Message-ID: <7976...|\n|<17442484.1075861...|Mon, 26 Nov 2001 07|sarah.wesner-soon...|john.arnold@enron...|Message-ID: <1744...|\n|<24327054.1075861...|Mon, 26 Nov 2001 07|paul.kaufman@enro...|lara.leibman@enro...|Message-ID: <2432...|\n|<4047575.10758616...|Mon, 26 Nov 2001 09|dutch.quigley@enr...|john.arnold@enron...|Message-ID: <4047...|\n|<12765432.1075861...|Mon, 26 Nov 2001 10|savita.puthigai@e...|john.arnold@enron...|Message-ID: <1276...|\n|<24221903.1075852...| Tue, 2 Oct 2001 09|matthew.arnold@en...|john.arnold@enron...|Message-ID: <2422...|\n|<1589070.10758616...|Mon, 26 Nov 2001 15|christopher.jeska...|john.arnold@enron...|Message-ID: <1589...|\n|<31738142.1075861...|Mon, 26 Nov 2001 16|john.lavorato@enr...|john.arnold@enron...|Message-ID: <3173...|\n|<8154954.10758616...|Mon, 26 Nov 2001 17|christopher.jeska...|john.arnold@enron...|Message-ID: <8154...|\n|<24012704.1075861...|Mon, 26 Nov 2001 19|  klarnold@flash.net|john.arnold@enron...|Message-ID: <2401...|\n|<22366853.1075861...|Mon, 26 Nov 2001 21|enron_update@conc...|   jarnold@enron.com|Message-ID: <2236...|\n|<9408142.10758616...|Tue, 27 Nov 2001 09|jennifer.white@oc...|john.arnold@enron...|Message-ID: <9408...|\n|<14163285.1075861...|Tue, 27 Nov 2001 10|kbusch@energyargu...|john.arnold@enron...|Message-ID: <1416...|\n|<7196800.10758616...|Tue, 27 Nov 2001 11|savita.puthigai@e...|john.arnold@enron...|Message-ID: <7196...|\n|<26452606.1075861...|Tue, 27 Nov 2001 11|frank.hayden@enro...|john.arnold@enron...|Message-ID: <2645...|\n|<26289660.1075861...|Tue, 27 Nov 2001 14|courtney.votaw@en...|X-cc: \r\nX-bcc: \r\n...|Message-ID: <2628...|\n|<15158563.1075852...| Wed, 3 Oct 2001 16|ravi.thuraisingha...|john.arnold@enron...|Message-ID: <1515...|\n|<5558138.10758616...|Tue, 27 Nov 2001 14| update@briefing.com|jarnold@ect.enron...|Message-ID: <5558...|\n|<94337.1075861676...|Tue, 27 Nov 2001 15|site59@site59.rsc...|   jarnold@enron.com|Message-ID: <9433...|\n|<8466544.10758616...|Tue, 27 Nov 2001 15|houston <.ward@en...|suzanne.vann@enro...|Message-ID: <8466...|\n|<26420747.1075861...|Tue, 27 Nov 2001 15|errol.mclaughlin@...|john.arnold@enron...|Message-ID: <2642...|\n|<27701631.1075861...|Tue, 27 Nov 2001 15|houston <.ward@en...|john.arnold@enron...|Message-ID: <2770...|\n|<9545824.10758616...|Tue, 27 Nov 2001 17|joey.taylor@enron...|john.arnold@enron...|Message-ID: <9545...|\n|<12926226.1075861...|Tue, 27 Nov 2001 17|  klarnold@flash.net|john.arnold@enron...|Message-ID: <1292...|\n|<24722291.1075852...| Sun, 7 Oct 2001 23|enron_update@conc...|   jarnold@enron.com|Message-ID: <2472...|\n|<3018301.10758527...| Tue, 9 Oct 2001 12|greg.woulfe@enron...|john.mee@williams...|Message-ID: <3018...|\n|<20372860.1075852...|Fri, 13 Jul 2001 13|  perfmgmt@enron.com|arnold@enron.com,...|Message-ID: <2037...|\n|<27845794.1075852...| Tue, 9 Oct 2001 18|creditprocessing@...|   jarnold@enron.com|Message-ID: <2784...|\n|<17224851.1075862...|Mon, 26 Nov 2001 17|joey.taylor@enron...|john.arnold@enron...|Message-ID: <1722...|\n|<23991542.1075862...|Mon, 26 Nov 2001 18|continental_airli...|jarnold@ect.enron...|Message-ID: <2399...|\n|<20601598.1075852...|Wed, 10 Oct 2001 12|steve.lafontaine@...|john.arnold@enron...|Message-ID: <2060...|\n|<2888907.10758527...|Wed, 10 Oct 2001 16|gcaspy@mba2002.hb...|john.arnold@enron...|Message-ID: <2888...|\n|<613149.107585272...|Wed, 10 Oct 2001 19|mike.grigsby@enro...|keith.holst@enron...|Message-ID: <6131...|\n|<3991189.10758527...|Mon, 15 Oct 2001 11|joey.taylor@enron...|john.arnold@enron...|Message-ID: <3991...|\n|<4604511.10758527...|Mon, 15 Oct 2001 19|administration.en...|All Enron Worldwi...|Message-ID: <4604...|\n|<11503836.1075852...|Tue, 16 Oct 2001 10| iris.mack@enron.com|iris.mack@enron.c...|Message-ID: <1150...|\n|<4346375.10758527...|Thu, 18 Oct 2001 07|savita.puthigai@e...|john.arnold@enron...|Message-ID: <4346...|\n|<1533810.10758527...|Fri, 19 Oct 2001 06| kislince@er.oge.com|   jarnold@enron.com|Message-ID: <1533...|\n|<8952460.10758527...|Mon, 22 Oct 2001 05| swl@winelibrary.com|   jarnold@enron.com|Message-ID: <8952...|\n|<17246131.1075852...|Mon, 16 Jul 2001 14|david.forster@enr...|john.arnold@enron...|Message-ID: <1724...|\n|<5935857.10758527...|Mon, 22 Oct 2001 11|margaret.allen@en...|john.arnold@enron...|Message-ID: <5935...|\n|<6634914.10758527...|Mon, 22 Oct 2001 21|no.address@enron.com|All Enron Worldwi...|Message-ID: <6634...|\n|<11633931.1075852...|Tue, 23 Oct 2001 06|kimberly.banner@e...|john.arnold@enron...|Message-ID: <1163...|\n|<9808921.10758527...|Tue, 23 Oct 2001 07| dmcelduff@nymex.com|john.arnold@enron...|Message-ID: <9808...|\n|<5618523.10758527...|Tue, 23 Oct 2001 16|karen.buckley@enr...|david.duran@enron...|Message-ID: <5618...|\n|<8351810.10758527...|Wed, 24 Oct 2001 07|ina.rangel@enron.com|john.arnold@enron...|Message-ID: <8351...|\n|<10682204.1075852...|Thu, 25 Oct 2001 09|kimberly.banner@e...|john.arnold@enron...|Message-ID: <1068...|\n|<19601228.1075852...|Thu, 25 Oct 2001 20|jennifer.fraser@e...|john.arnold@enron...|Message-ID: <1960...|\n|<428136.107585272...|Fri, 26 Oct 2001 05|frank.hayden@enro...|john.arnold@enron...|Message-ID: <4281...|\n|<15048276.1075852...|Fri, 26 Oct 2001 06|m..schmidt@enron.com|X-cc: \r\nX-bcc: \r\n...|Message-ID: <1504...|\n|<12548114.1075852...|Tue, 17 Jul 2001 16|jonathan.whitehea...|john.arnold@enron...|Message-ID: <1254...|\n|<16622178.1075852...|Fri, 26 Oct 2001 06|joannie.williamso...|john.arnold@enron...|Message-ID: <1662...|\n|<28313031.1075852...|Fri, 26 Oct 2001 07|no.address@enron.com|All Enron Houston...|Message-ID: <2831...|\n|<21724914.1075852...|Fri, 26 Oct 2001 07|michael.gapinski@...|gapinski@enron.co...|Message-ID: <2172...|\n|<24862529.1075852...|Fri, 26 Oct 2001 07|fzerilli@powermer...|john.arnold@enron...|Message-ID: <2486...|\n|<11184714.1075852...|Fri, 26 Oct 2001 08|kimberly.banner@e...|john.arnold@enron...|Message-ID: <1118...|\n|<9570725.10758527...|Fri, 26 Oct 2001 08|s..shively@enron.com|john.arnold@enron...|Message-ID: <9570...|\n|<28797805.1075852...|Fri, 26 Oct 2001 09|fzerilli@powermer...|john.arnold@enron...|Message-ID: <2879...|\n|<15585631.1075852...|Fri, 26 Oct 2001 11|karen.buckley@enr...|k..allen@enron.co...|Message-ID: <1558...|\n|<21812813.1075852...|Fri, 26 Oct 2001 14|store-news@amazon...|jarnold@ect.enron...|Message-ID: <2181...|\n|<25779974.1075852...|Sat, 27 Oct 2001 20|mike.grigsby@enro...|john.arnold@enron...|Message-ID: <2577...|\n|<6551177.10758527...|Tue, 17 Jul 2001 17|denver.plachy@enr...|john.arnold@enron...|Message-ID: <6551...|\n|<29209841.1075852...|Sun, 28 Oct 2001 05|john.lavorato@enr...|john.arnold@enron...|Message-ID: <2920...|\n|<28457755.1075852...|Sun, 28 Oct 2001 18|caroline.abramo@e...|john.arnold@enron...|Message-ID: <2845...|\n|<4624758.10758527...|Sun, 28 Oct 2001 18|john.lavorato@enr...|john.arnold@enron...|Message-ID: <4624...|\n|<16257936.1075852...|Mon, 29 Oct 2001 05|lenny.hochschild@...|john.arnold@enron...|Message-ID: <1625...|\n|<13395955.1075852...|Mon, 29 Oct 2001 06|m..schmidt@enron.com|X-cc: \r\nX-bcc: \r\n...|Message-ID: <1339...|\n|<29138592.1075852...|Mon, 29 Oct 2001 07|jeanie.slone@enro...|john.arnold@enron...|Message-ID: <2913...|\n|<5385659.10758527...|Mon, 29 Oct 2001 09|fzerilli@powermer...|john.arnold@enron...|Message-ID: <5385...|\n|<20468013.1075852...|Mon, 29 Oct 2001 09|mike.grigsby@enro...|john.lavorato@enr...|Message-ID: <2046...|\n|<5870392.10758527...|Mon, 29 Oct 2001 10|m..schmidt@enron.com|X-cc: \r\nX-bcc: \r\n...|Message-ID: <5870...|\n|<13655663.1075852...|Mon, 29 Oct 2001 12|ina.rangel@enron.com|jay.reitmeyer@enr...|Message-ID: <1365...|\n|<13556517.1075852...|Wed, 18 Jul 2001 06|john.griffith@enr...|john.arnold@enron...|Message-ID: <1355...|\n|<31967699.1075852...|Mon, 29 Oct 2001 12|dudley.poston@wil...|brenden.oneil@koc...|Message-ID: <3196...|\n|<7566602.10758527...|Mon, 29 Oct 2001 12|dudley.poston@wil...|   jarnold@enron.com|Message-ID: <7566...|\n|<594410.107585273...|Mon, 29 Oct 2001 13|savita.puthigai@e...|john.arnold@enron...|Message-ID: <5944...|\n|<24593337.1075852...|Mon, 29 Oct 2001 13|john.lavorato@enr...|john.arnold@enron...|Message-ID: <2459...|\n|<16732279.1075852...|Mon, 29 Oct 2001 15|errol.mclaughlin@...|john.arnold@enron...|Message-ID: <1673...|\n|<33287304.1075852...|Mon, 29 Oct 2001 15|david.deveny@bmo.com|   jarnold@enron.com|Message-ID: <3328...|\n|<6688033.10758527...|Mon, 29 Oct 2001 21|enron_update@conc...|   jarnold@enron.com|Message-ID: <6688...|\n|<13735813.1075855...|Tue, 27 Nov 2001 15|hrobertson@clough...|john.arnold@enron...|Message-ID: <1373...|\n|<3330431.10758552...|Thu, 29 Nov 2001 06|bob.shiring@rweam...|john.arnold@enron...|Message-ID: <3330...|\n|<5770983.10758552...| Wed, 5 Dec 2001 13|ina.rangel@enron.com|john.arnold@enron...|Message-ID: <5770...|\n|<9795398.10758527...|Wed, 15 Aug 2001 16|john.arnold@enron...|john.arnold@enron...|Message-ID: <9795...|\n|<20613087.1075855...| Fri, 7 Dec 2001 09|credit <.williams...|john.arnold@enron...|Message-ID: <2061...|\n|<28212896.1075855...| Fri, 7 Dec 2001 10|ltaylor@heidrick.com|john.arnold@enron...|Message-ID: <2821...|\n|<16469165.1075855...|Mon, 10 Dec 2001 08|steve.lafontaine@...|   jarnold@enron.com|Message-ID: <1646...|\n|<6749341.10758552...|Tue, 11 Dec 2001 09|steve.lafontaine@...|   jarnold@enron.com|Message-ID: <6749...|\n|<22210624.1075855...|Thu, 13 Dec 2001 08|rick.wurlitzer@en...|m..presto@enron.c...|Message-ID: <2221...|\n|<905155.107585521...|Sat, 15 Dec 2001 15|my-login-request@...|   jarnold@enron.com|Message-ID: <9051...|\n|<12795001.1075855...|Mon, 17 Dec 2001 14|no.address@enron.com|All Enron Worldwi...|Message-ID: <1279...|\n|<28787165.1075855...|Wed, 19 Dec 2001 06|jeb.ligums@enron.com|john.arnold@enron...|Message-ID: <2878...|\n|<4542866.10758552...|Wed, 19 Dec 2001 08|michael.gapinski@...|john.arnold@enron...|Message-ID: <4542...|\n|<15620299.1075855...|Fri, 21 Dec 2001 09|george.ellis@amer...|george.ellis@amer...|Message-ID: <1562...|\n|<13213496.1075852...|Wed, 22 Aug 2001 12|anthony.dayao@enr...|john.lavorato@enr...|Message-ID: <1321...|\n|<494436.107585521...|Fri, 21 Dec 2001 11|travelercare@orbi...|john.arnold@enron...|Message-ID: <4944...|\n|<22055070.1075855...|Wed, 26 Dec 2001 10|keith.karako@citi...|john.arnold@enron...|Message-ID: <2205...|\n|<3753984.10758552...|Thu, 27 Dec 2001 14|ed.mcmichael@enro...|brian.manolis@ame...|Message-ID: <3753...|\n|<10888774.1075855...|Thu, 27 Dec 2001 14|louise.kitchen@en...|tim.belden@enron....|Message-ID: <1088...|\n|<1765968.10758552...|Thu, 27 Dec 2001 15|no.address@enron.com|Announcement Grou...|Message-ID: <1765...|\n|<18511291.1075855...|Fri, 28 Dec 2001 06|carrfuturesenergy...|smollner@carrfut.com|Message-ID: <1851...|\n|<2581043.10758552...|Sat, 29 Dec 2001 03|   news@real-net.net|jarnold@ei.enron.com|Message-ID: <2581...|\n|<27265415.1075855...|Sat, 29 Dec 2001 15|  sales@popswine.com|   jarnold@enron.com|Message-ID: <2726...|\n|<30514342.1075855...|Sun, 30 Dec 2001 07|editor@casinoswee...|jarnold@ect.enron...|Message-ID: <3051...|\n|<8608332.10758552...|Sun, 30 Dec 2001 12|  amore889@yahoo.com|  amore889@yahoo.com|Message-ID: <8608...|\n|<16009004.1075852...| Wed, 5 Sep 2001 07| iris.mack@enron.com|john.arnold@enron...|Message-ID: <1600...|\n|<27090406.1075855...|Mon, 31 Dec 2001 04|carrfuturesenergy...|smollner@carrfut.com|Message-ID: <2709...|\n|<8371823.10758552...|Mon, 31 Dec 2001 05|  capstone@texas.net|bob.mckinney@caps...|Message-ID: <8371...|\n+--------------------+-------------------+--------------------+--------------------+--------------------+\nonly showing top 200 rows\n\n"}]},"apps":[],"jobName":"paragraph_1556642945544_185640021","id":"20190430-164905_1568927929","dateCreated":"2019-04-30T16:49:05+0000","dateStarted":"2019-04-30T20:13:38+0000","dateFinished":"2019-04-30T20:14:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2201"},{"text":"%spark2.pyspark\n# performed these steps to ensure the resultant csv works, it\n# was not working until I added the \"DROPMALFORMED\" mode\n\nfrom pyspark.sql.types import StructField, StructType, StringType\nschema = StructType([\n    StructField(\"MessageID\", StringType()),\n    StructField(\"Date\", StringType()),\n    StructField(\"From\", StringType()),\n    StructField(\"To\", StringType()),\n    StructField(\"Message\", StringType())])\n     \n\ndf = spark.read.format(\"csv\").schema(schema).option(\"header\", \"false\").option(\"mode\",\"DROPMALFORMED\").load(\"file:///data/enronCombined.csv\")\ndf.show(6)","user":"anonymous","dateUpdated":"2019-05-01T00:26:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------------------+--------------------+--------------------+--------------------+\n|           MessageID|               Date|                From|                  To|             Message|\n+--------------------+-------------------+--------------------+--------------------+--------------------+\n|           MessageID|               Date|                From|                  To|                Body|\n|<16159836.1075855...| Fri, 7 Dec 2001 10|heather.dunton@en...|  k..allen@enron.com|Message-ID: <1615...|\n|<14955894.1075855...|Sun, 30 Dec 2001 22|anchordesk_daily@...|    pallen@enron.com|Message-ID: <1495...|\n|<7462038.10758553...|Sun, 30 Dec 2001 23|subscriptions@int...|    pallen@enron.com|Message-ID: <7462...|\n|<21572157.1075855...|Mon, 31 Dec 2001 02|prizemachine@feed...|    pallen@enron.com|Message-ID: <2157...|\n|<7618763.10758553...|Mon, 31 Dec 2001 10|louise.kitchen@en...|wes.colwell@enron...|Message-ID: <7618...|\n+--------------------+-------------------+--------------------+--------------------+--------------------+\nonly showing top 6 rows\n\n"}]},"apps":[],"jobName":"paragraph_1556643006966_-597711004","id":"20190430-165006_911280779","dateCreated":"2019-04-30T16:50:06+0000","dateStarted":"2019-05-01T00:09:53+0000","dateFinished":"2019-05-01T00:09:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2202"},{"text":"%spark2.pyspark\n# troubleshooting the misalignment with the read csv.\nfrom pyspark.sql.functions import col\ndf2 = df.where(col('Message').like('%Message-ID: <5870%'))\ndf2.show()","user":"anonymous","dateUpdated":"2019-05-01T00:08:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------------------+--------------------+--------------------+--------------------+\n|           MessageID|               Date|                From|                  To|             Message|\n+--------------------+-------------------+--------------------+--------------------+--------------------+\n|<5870392.10758527...|Mon, 29 Oct 2001 10|m..schmidt@enron.com|X-cc: \r\nX-bcc: \r\n...|Message-ID: <5870...|\n|<5870308.10758633...|Mon, 30 Jul 2001 13|holly.fuller@elpa...|robert.benson@enr...|Message-ID: <5870...|\n|<5870360.10758609...| Fri, 1 Mar 2002 07|communications@en...|dl-ga-all_enron_h...|Message-ID: <5870...|\n|<5870637.10758410...|Thu, 31 Jan 2002 12|sanjeev.gupta@enr...|   m..love@enron.com|Message-ID: <5870...|\n+--------------------+-------------------+--------------------+--------------------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1556652065528_387648206","id":"20190430-192105_1276529015","dateCreated":"2019-04-30T19:21:05+0000","dateStarted":"2019-04-30T21:25:00+0000","dateFinished":"2019-04-30T21:37:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2203"},{"text":"%spark2.pyspark\n# Ran this on OS so as to save myself the time it takes to coalesce\n\n#!/bin/bash\n#echo \"MessageID,Date,From,To,Body\" > /data/enronCombined.csv\n#for i in /tmp/enron/*.csv ; do\n#    echo \"Processing $i\"\n#    cat $i >> /data/enronCombined.csv\n#    rm $i\n#done\n#echo \"Done\"","user":"anonymous","dateUpdated":"2019-05-01T00:09:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1556652314746_-1875943230","id":"20190430-192514_2106747157","dateCreated":"2019-04-30T19:25:14+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2204"}],"name":"Week2 Assignment Hagan","id":"2EBRQNG32","noteParams":{},"noteForms":{},"angularObjects":{"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}